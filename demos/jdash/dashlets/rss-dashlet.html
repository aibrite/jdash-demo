<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.0/angular.min.js"></script>

<j-dashlet id="rss-dashlet" title="Angular Sample" data-order="7">
    <template>
        <div class="j-padding">
            <div>
                <h3>Jdash supports any JavaScript library inside your dashlets. This is a demo of Angular Javascript Library.</h3>
            </div>
            <div ng-controller="MainCtrl as $ctrl">
                <h1 style="margin-left: 10px;">Using $timeout to display a random value.</h1>
                <h2 style="color:cornflowerblue; margin-left: 10px;">{{$ctrl.myfoo|number:2}}</h2>
            </div>
        </div>
    </template>

    <script>
        jdash.define(function () {

            this.addEventListener('drag-start', function (e) {

            })

            this.configurationChanged = function (key, oldVal, newVal) {

            }

            this.positionChanged = function (key, oldVal, newVal) {

            }

            // this.configLoaded = function (oldVal, newVal) {
            //     console.log(`Config chaged for ${this.tagName} ${newVal}`);
            //     this.config.changeCallback = this.configChanged.bind(this);
            // }

            this.attributeChanged = function (name, oldVal, newVal) {

            }

            this.initialized = function () {
                angular.element(document).ready(function () {
                    angular.bootstrap(this.elementContent, ['JDashNetDemo']);
                }.bind(this));
                // this.querySelector('#testbtn').addEventListener('click', function () {
                //     var oldConfig = this.config;
                //     oldConfig.limit = 111;
                // }.bind(this))
            }
        });
    </script>
</j-dashlet>

<!--<j-dashlet-editor id="rss-dashlet-editor">
    <template>
        <h3 style="margin: 20px;">Editor example for RSS Dashlet</h3>
    </template>
</j-dashlet-editor>-->

<script>
    angular.element(document).ready(function () {
        var app = angular.module('JDashNetDemo', []).run();
        angular.module('JDashNetDemo').controller('MainCtrl', function ($scope, $timeout) {
            this.myfoo = Math.random().toString();
            this.editor = function () {
                this.editorOpen = true;
            }

            setInterval(function () {
                $timeout(function () {
                    this.myfoo = Math.random().toString(), 1500
                }.bind(this));
            }.bind(this), 1500);
            $timeout(function () {
                this.myfoo = Math.random().toString(), 1500
            }.bind(this))
        });
    });

</script>